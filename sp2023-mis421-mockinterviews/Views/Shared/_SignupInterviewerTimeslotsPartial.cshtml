@using sp2023_mis421_mockinterviews.Data.Constants
@model sp2023_mis421_mockinterviews.Models.ViewModels.IndexViewModel

<h3>Assigned Interviews</h3>
@if (Model.InterviewerScheduledInterviews.Count() > 0)
{
    <table class="table">
        <thead>
            <tr>
                <th>Student</th>
                <th>Class</th>
                <th>Interview Type</th>
                <th>Timer</th>
                <th>Update Status</th>
                <th>View Profile</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var interviewEventViewModel in Model.InterviewerScheduledInterviews)
            {
                <tr>
                    @if (interviewEventViewModel.InterviewEvent.InterviewerTimeslot == null)
                    {
                        <td>Not Assigned</td>
                    }
                    else
                    {
                        <td>@interviewEventViewModel.StudentName</td>
                    }
                    <td>@interviewEventViewModel.Class</td>
                    <td>@interviewEventViewModel.InterviewEvent.Type</td>
                    <td id="timer-@interviewEventViewModel.InterviewEvent.Id">@interviewEventViewModel.InterviewEvent.StartedAt</td>
                    <td>
                        <a id="canBeRemoved-@interviewEventViewModel.InterviewEvent.Id" 
                            class="btn btn-primary"
                            asp-action="StudentComplete" 
                            asp-route-id="@interviewEventViewModel.InterviewEvent.Id" 
                            asp-controller="InterviewEvents">I'm Done</a>
                    </td>
                    <td>
                        <a asp-controller="Users" asp-action="ExternalUserProfileView" asp-route-userId="@interviewEventViewModel.InterviewEvent.StudentId">View @interviewEventViewModel.StudentName's Profile</a>
                    </td>

                </tr>
            }
        </tbody>
    </table>
}
else
{
    <p>No upcoming events</p>
}
<br />
<h3>Interviewer Schedule</h3>
@if (Model.InterviewerRangeViewModels.Count() > 0)
{
    <div id="center-everything">
        <h4>@Model.InterviewerRangeViewModels[0].Location</h4>
    </div>
    <table class="table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Time</th>
                <th>Location</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var signupInterviewerTimeslot in Model.InterviewerRangeViewModels)
            {
                if (signupInterviewerTimeslot.SignupInterviewerId == Model.SignupInterviewerId1)
                {
                    <tr>
                        <td class="date-column">@signupInterviewerTimeslot.Date</td>
                        <td>@signupInterviewerTimeslot.StartTime - @signupInterviewerTimeslot.EndTime</td>
                        <td>@signupInterviewerTimeslot.Location</td>
                    </tr>
                }
            }
        </tbody>
    </table>
    <div id="center-everything">
        <a class="btn btn-primary" asp-controller="SignupInterviewerTimeslots" asp-action="Edit" asp-route-id="@Model.SignupInterviewerId1">Edit</a> | 
        <a class="btn btn-secondary" asp-controller="SignupInterviewerTimeslots" asp-action="UserDeleteRange" asp-route-id="@Model.SignupInterviewerId1">Cancel</a>
    </div>

    if(Model.SignupInterviewerId2 != null)
    {
        <br /><br />
        <div id="center-everything">
            @if (Model.InterviewerRangeViewModels[0].Location == InterviewLocationConstants.InPerson)
            {
                <h4>In Person</h4>
            }
            else
            {
                <h4>Virtual</h4>
            }
        </div>
        <table class="table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Time</th>
                    <th>Location</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var signupInterviewerTimeslot in Model.InterviewerRangeViewModels)
                {
                    if (signupInterviewerTimeslot.SignupInterviewerId == Model.SignupInterviewerId2)
                    {
                        <tr>
                            <td class="date-column">@signupInterviewerTimeslot.Date</td>
                            <td>@signupInterviewerTimeslot.StartTime - @signupInterviewerTimeslot.EndTime</td>
                            <td>@signupInterviewerTimeslot.Location</td>
                        </tr>
                    }
                }
            </tbody>
        </table>
        <div id="center-everything">
            <a class="btn btn-primary" asp-controller="SignupInterviewerTimeslots" asp-action="Edit" asp-route-id="@Model.SignupInterviewerId2">Edit</a> |
            <a class="btn btn-secondary" asp-controller="SignupInterviewerTimeslots" asp-action="UserDeleteRange" asp-route-id="@Model.SignupInterviewerId2">Cancel</a>
        </div>
    }
}
else
{
    <p>No upcoming events</p>
}
<br />
<h3>Completed Interviews</h3>
@if (Model.CompletedInterviews.Count() > 0)
{
    <table class="table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Time</th>
                <th>Student</th>
                <th>Interview Type</th>
                <th>View Profile</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var interviewEventViewModel in Model.CompletedInterviews)
            {
                <tr>
                    <td class="date-column">@interviewEventViewModel.InterviewEvent.Timeslot.Event.Date</td>
                    <td class="time-column">@interviewEventViewModel.InterviewEvent.Timeslot.Time</td>
                    @if (interviewEventViewModel.InterviewEvent.InterviewerTimeslot == null)
                    {
                        <td>Not Assigned</td>
                    }
                    else
                    {
                        <td>@interviewEventViewModel.StudentName</td>
                    }
                    <td>@interviewEventViewModel.InterviewEvent.Type</td>
                    <td>
                        <a asp-controller="Users" asp-action="ExternalUserProfileView" asp-route-userId="@interviewEventViewModel.InterviewEvent.StudentId">View @interviewEventViewModel.StudentName's Profile</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <p>No completed interviews</p>
}
<br />